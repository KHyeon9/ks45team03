<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ks45team03.rentravel.mapper.GoodsMapper" >    

	<resultMap type="Goods" id="goodsResultMap">
		<id property="goodsCode" 			column="goods_code"/>
		<result property="goodsName" 		column="goods_name"/>
		<result property="goodsCategoryCode" 		column="goods_category_code"/>
		<result property="userId" 	column="user_id"/>
		<result property="goodsRentalAvailability" 	column="goods_rental_availability"/>
		<result property="goodsValuePrice" 	column="goods_value_price"/>
		<result property="goodsPurchaseDate" 	column="goods_purchase_date"/>
		<result property="goodsDayPrice" 	column="goods_day_price"/>
		<result property="commisionRateCode" 	column="commision_rate_code"/>
		<result property="commisionRate" 	column="commision_rate"/>
		<result property="goodsCommisionDayPrice" 	column="goods_commision_day_price"/>
		<result property="goodsDetail" 	column="goods_detail"/>
		<result property="goodsRegDate" 	column="goods_reg_date"/>
		<result property="regionSggCode" 	column="region_sgg_code"/>
		<result property="goodsCategoryName" 	column="goods_category_name"/>
		
	</resultMap>

	<resultMap type="GoodsImg" id="goodsImgResultMap">
		<id property="goodsImgCode" 			column="goods_img_code"/>
		<result property="goodsImg" 		column="goods_img"/>
		<result property="goodsImgRowNum" 		column="row_number() OVER()"/>
	</resultMap>

    <select id="getGoodsList" resultMap="goodsResultMap">
    
    /* 상품 목록 리스트 조회 */
		SELECT
			g.goods_code
			, g.goods_name
			, g.user_id
			, g.goods_rental_availability
			, g.goods_value_price
			, g.goods_day_price
			, g.goods_reg_date
			, gc.goods_category_name
		FROM
			tb_goods AS g
		JOIN
			tb_goods_category AS gc
		ON
			g.goods_category_code = gc.goods_category_code;
    
    </select>
    
    <select id="getGoodsImg" parameterType="String" resultMap="goodsImgResultMap">
		SELECT
			gi.goods_img_code
			,gi.goods_img
			,row_number() OVER()
		FROM
			tb_goods AS g
		JOIN
			tb_goods_img AS gi
		ON
			g.goods_code = gi.goods_code
		WHERE
			g.goods_code = #{goodsCode};
    </select>
    
</mapper>